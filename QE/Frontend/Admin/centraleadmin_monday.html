<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>La Centrale - Admin (Monday Style)</title>

  <!-- PWA Meta Tags -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#1f2937">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Qwota">
  <meta name="msapplication-TileColor" content="#1f2937">

  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.webmanifest">

  <!-- Icônes PWA -->
  <link rel="icon" type="image/png" sizes="192x192" href="/static/icons/icon-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/static/icons/icon-512x512.png">
  <link rel="apple-touch-icon" href="/static/icons/icon-192x192.png">

  <!-- Scripts -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link rel="icon" href="/favicon" type="image/x-icon" />

  <!-- Script commun -->
  <script src="/common.js"></script>

  <!-- Feuille de style principale -->
  <link rel="stylesheet" href="/base.css">

  <!-- Feuille de style Monday -->
  <link rel="stylesheet" href="/centraleadmin_monday.css">
</head>

<body class="min-h-screen centrale-admin-monday">

  <!-- Header -->
  <div class="monday-header">
    <div class="relative">
      <h1 class="text-4xl font-bold mb-3">
        La Centrale
      </h1>
      <span class="absolute -bottom-2 left-0 w-20 h-1 bg-gradient-to-r from-blue-600 to-blue-400 rounded-full"></span>
      <div class="flex items-center justify-between mt-6">
        <p class="text-xl font-medium">Centre de ressources et documentation</p>
        <button id="add-board-btn" class="monday-btn-primary">
          <i class="fas fa-plus mr-2"></i>
          Nouveau board
        </button>
      </div>
    </div>

    <!-- Sélecteur de type de centrale -->
    <div style="background: var(--bg-card); border-radius: 16px; padding: 1.5rem; margin-top: 2rem; box-shadow: var(--shadow-dark-medium); border: 1px solid var(--border-dark);">
      <div style="display: flex; align-items: center; gap: 1rem;">
        <label style="font-size: 1rem; font-weight: 600; color: var(--text-light); display: flex; align-items: center; gap: 0.5rem;">
          <i class="fas fa-building"></i>
          <span>Gérer la centrale:</span>
        </label>
        <div style="display: flex; gap: 1rem;">
          <button id="select-coach-centrale" class="centrale-type-btn active" data-type="coach">
            <i class="fas fa-user-shield mr-2"></i>Centrale Coach
          </button>
          <button id="select-entrepreneur-centrale" class="centrale-type-btn" data-type="entrepreneur">
            <i class="fas fa-users mr-2"></i>Centrale Entrepreneur
          </button>
        </div>
        <span id="current-centrale-type" style="margin-left: auto; font-size: 0.875rem; color: var(--text-gray); font-style: italic;">
          Actuellement: <strong id="current-centrale-name">Centrale Coach</strong>
        </span>
      </div>
    </div>
  </div>

  <!-- Boards container -->
  <div class="monday-container">
    <div id="boards-container" class="monday-boards">
      <!-- Les boards seront insérés ici -->
    </div>

    <!-- Empty state -->
    <div id="empty-state" class="monday-empty-state">
      <div class="empty-state-icon">
        <i class="fas fa-layer-group"></i>
      </div>
      <h3 class="empty-state-title">Aucun board créé</h3>
      <p class="empty-state-text">Créez votre premier board pour organiser vos ressources</p>
      <button id="add-board-empty" class="monday-btn-primary">
        <i class="fas fa-plus mr-2"></i>
        Créer un board
      </button>
    </div>
  </div>

  <!-- Modal: Créer/Modifier Board -->
  <div id="boardModal" class="monday-modal-overlay" style="display: none;">
    <div class="monday-modal">
      <div class="monday-modal-header">
        <h3 id="boardModalTitle">Nouveau board</h3>
        <button class="monday-modal-close" onclick="closeBoardModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="monday-modal-body">
        <div class="form-group">
          <label class="form-label">Nom du board</label>
          <input type="text" id="boardName" class="monday-input" placeholder="Ex: Formation, Documentation RH...">
        </div>

        <div class="form-group">
          <label class="form-label">Icône du board</label>
          <div class="icon-picker">
            <div class="icon-picker-selected" id="selectedIcon" onclick="toggleIconGrid()">
              <i class="fas fa-folder"></i>
            </div>
            <div class="icon-picker-grid" id="iconGrid" style="display: none;">
              <!-- Icons generated in JS -->
            </div>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Couleur du board</label>
          <div class="color-picker">
            <div class="color-option" data-color="#3b82f6" style="background: #3b82f6;"></div>
            <div class="color-option" data-color="#10b981" style="background: #10b981;"></div>
            <div class="color-option" data-color="#f59e0b" style="background: #f59e0b;"></div>
            <div class="color-option" data-color="#ef4444" style="background: #ef4444;"></div>
            <div class="color-option" data-color="#8b5cf6" style="background: #8b5cf6;"></div>
            <div class="color-option" data-color="#ec4899" style="background: #ec4899;"></div>
            <div class="color-option" data-color="#06b6d4" style="background: #06b6d4;"></div>
            <div class="color-option" data-color="#84cc16" style="background: #84cc16;"></div>
          </div>
        </div>
      </div>

      <div class="monday-modal-footer">
        <button class="monday-btn-secondary" onclick="closeBoardModal()">Annuler</button>
        <button class="monday-btn-primary" onclick="saveBoard()">
          <i class="fas fa-check mr-2"></i>
          Créer le board
        </button>
      </div>
    </div>
  </div>

  <!-- Modal: Ajouter une colonne -->
  <div id="columnModal" class="monday-modal-overlay" style="display: none;">
    <div class="monday-modal">
      <div class="monday-modal-header">
        <h3>Ajouter une colonne</h3>
        <button class="monday-modal-close" onclick="closeColumnModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="monday-modal-body">
        <div class="form-group">
          <label class="form-label">Type de colonne</label>
          <div class="column-types-grid">
            <div class="column-type-card" data-type="texte">
              <div class="column-type-icon" style="background: rgba(59, 130, 246, 0.1); color: #3b82f6;">
                <i class="fas fa-font"></i>
              </div>
              <div class="column-type-label">Texte</div>
              <div class="column-type-desc">Champ texte libre</div>
            </div>

            <div class="column-type-card" data-type="numero">
              <div class="column-type-icon" style="background: rgba(16, 185, 129, 0.1); color: #10b981;">
                <i class="fas fa-hashtag"></i>
              </div>
              <div class="column-type-label">Numéro</div>
              <div class="column-type-desc">Valeur numérique</div>
            </div>

            <div class="column-type-card" data-type="fichier">
              <div class="column-type-icon" style="background: rgba(245, 158, 11, 0.1); color: #f59e0b;">
                <i class="fas fa-paperclip"></i>
              </div>
              <div class="column-type-label">Fichiers</div>
              <div class="column-type-desc">Upload de fichiers</div>
            </div>

            <div class="column-type-card" data-type="lien">
              <div class="column-type-icon" style="background: rgba(139, 92, 246, 0.1); color: #8b5cf6;">
                <i class="fas fa-link"></i>
              </div>
              <div class="column-type-label">Lien</div>
              <div class="column-type-desc">URL externe</div>
            </div>

            <div class="column-type-card" data-type="date">
              <div class="column-type-icon" style="background: rgba(236, 72, 153, 0.1); color: #ec4899;">
                <i class="fas fa-calendar"></i>
              </div>
              <div class="column-type-label">Date</div>
              <div class="column-type-desc">Sélecteur de date</div>
            </div>

            <div class="column-type-card" data-type="statut">
              <div class="column-type-icon" style="background: rgba(6, 182, 212, 0.1); color: #06b6d4;">
                <i class="fas fa-circle"></i>
              </div>
              <div class="column-type-label">Statut</div>
              <div class="column-type-desc">Label de statut</div>
            </div>
          </div>
        </div>

        <div class="form-group" id="columnNameGroup" style="display: none;">
          <label class="form-label">Nom de la colonne</label>
          <input type="text" id="columnName" class="monday-input" placeholder="Ex: Responsable, Date limite...">
        </div>
      </div>

      <div class="monday-modal-footer">
        <button class="monday-btn-secondary" onclick="closeColumnModal()">Annuler</button>
        <button class="monday-btn-primary" id="saveColumnBtn" onclick="saveColumn()" disabled>
          <i class="fas fa-check mr-2"></i>
          Ajouter
        </button>
      </div>
    </div>
  </div>

  <!-- Modal: Ajouter un fichier/lien -->
  <div id="fileModal" class="monday-modal-overlay" style="display: none;">
    <div class="monday-modal">
      <div class="monday-modal-header">
        <h3>Ajouter un fichier ou un lien</h3>
        <button class="monday-modal-close" onclick="closeFileModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="monday-modal-body">
        <div class="form-group">
          <label class="form-label">Type</label>
          <div class="file-type-selector">
            <input type="radio" name="fileType" value="upload" id="fileTypeUpload" checked onchange="toggleFileType()">
            <label for="fileTypeUpload" class="file-type-option">
              <i class="fas fa-cloud-upload-alt"></i>
              <span>Upload fichier</span>
            </label>

            <input type="radio" name="fileType" value="link" id="fileTypeLink" onchange="toggleFileType()">
            <label for="fileTypeLink" class="file-type-option">
              <i class="fas fa-link"></i>
              <span>Lien externe</span>
            </label>
          </div>
        </div>

        <div class="form-group" id="fileUploadGroup">
          <label class="form-label">Fichier</label>
          <div class="custom-file-upload">
            <input type="file" id="fileUpload" style="display: none;" onchange="updateFileLabel()">
            <button type="button" class="monday-btn-secondary" onclick="document.getElementById('fileUpload').click()">
              <i class="fas fa-cloud-upload-alt mr-2"></i>
              Choisir un fichier
            </button>
            <span id="fileUploadLabel" class="file-upload-label">Aucun fichier sélectionné</span>
          </div>
        </div>

        <div class="form-group" id="fileLinkGroup" style="display: none;">
          <label class="form-label">Nom du lien</label>
          <input type="text" id="fileName" class="monday-input" placeholder="Ex: Document important">
        </div>

        <div class="form-group" id="fileUrlGroup" style="display: none;">
          <label class="form-label">URL</label>
          <input type="url" id="fileUrl" class="monday-input" placeholder="https://exemple.com/fichier.pdf">
        </div>
      </div>

      <div class="monday-modal-footer">
        <button class="monday-btn-secondary" onclick="closeFileModal()">Annuler</button>
        <button class="monday-btn-primary" onclick="saveFile()">
          <i class="fas fa-check mr-2"></i>
          Ajouter
        </button>
      </div>
    </div>
  </div>

  <!-- Modal: Choisir un statut -->
  <div id="statusModal" class="monday-modal-overlay" style="display: none;">
    <div class="monday-modal">
      <div class="monday-modal-header">
        <h3>Choisir un statut</h3>
        <button class="monday-modal-close" onclick="closeStatusModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="monday-modal-body">
        <div class="form-group">
          <label class="form-label">Statuts prédéfinis</label>
          <div class="status-list" id="statusList">
            <div class="status-item" data-label="À faire" data-color="#64748b" onclick="selectStatus(this)">
              <span class="status-preview" style="background: #64748b;">À faire</span>
            </div>
            <div class="status-item" data-label="En cours" data-color="#3b82f6" onclick="selectStatus(this)">
              <span class="status-preview" style="background: #3b82f6;">En cours</span>
            </div>
            <div class="status-item" data-label="Terminé" data-color="#10b981" onclick="selectStatus(this)">
              <span class="status-preview" style="background: #10b981;">Terminé</span>
            </div>
            <div class="status-item" data-label="Bloqué" data-color="#ef4444" onclick="selectStatus(this)">
              <span class="status-preview" style="background: #ef4444;">Bloqué</span>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Ou créer un nouveau statut</label>
          <input type="text" id="customStatusLabel" class="monday-input" placeholder="Ex: En révision">
        </div>

        <div class="form-group">
          <label class="form-label">Couleur</label>
          <div class="color-picker">
            <div class="color-option" data-color="#64748b" style="background: #64748b;"></div>
            <div class="color-option" data-color="#3b82f6" style="background: #3b82f6;"></div>
            <div class="color-option" data-color="#10b981" style="background: #10b981;"></div>
            <div class="color-option" data-color="#f59e0b" style="background: #f59e0b;"></div>
            <div class="color-option" data-color="#ef4444" style="background: #ef4444;"></div>
            <div class="color-option" data-color="#8b5cf6" style="background: #8b5cf6;"></div>
            <div class="color-option" data-color="#ec4899" style="background: #ec4899;"></div>
            <div class="color-option" data-color="#06b6d4" style="background: #06b6d4;"></div>
          </div>
        </div>
      </div>

      <div class="monday-modal-footer">
        <button class="monday-btn-secondary" onclick="closeStatusModal()">Annuler</button>
        <button class="monday-btn-primary" onclick="saveStatus()">
          <i class="fas fa-check mr-2"></i>
          Valider
        </button>
      </div>
    </div>
  </div>

  <!-- Modal: File Viewer -->
  <div id="fileViewerModal" class="monday-modal-overlay" style="display: none;">
    <div class="monday-modal file-viewer-modal">
      <div class="monday-modal-header">
        <span id="fileViewerTitle" style="font-size: 1.125rem; font-weight: 600; color: var(--text-light);"></span>
        <button class="monday-modal-close" onclick="closeFileViewer()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="monday-modal-body">
        <div id="fileViewerContent">
          <!-- File content will be loaded here -->
        </div>
      </div>

      <div class="monday-modal-footer">
        <a id="fileViewerDownload" href="#" download class="monday-btn-secondary" style="text-decoration: none;">
          <i class="fas fa-download mr-2"></i>
          Télécharger
        </a>
        <button class="monday-btn-primary" onclick="closeFileViewer()">Fermer</button>
      </div>
    </div>
  </div>

  <script src="/centraleadmin_monday.js"></script>
  <script src="/centraleadmin_monday_fichiers.js"></script>
</body>
</html>
