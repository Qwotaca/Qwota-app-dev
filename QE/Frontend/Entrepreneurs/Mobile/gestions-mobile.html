<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Gestion Mobile - Qwota (Dark Theme)</title>

  <!-- üì± PWA Meta Tags -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#1f2937">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Qwota">
  <meta name="msapplication-TileColor" content="#1f2937">

  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.webmanifest">

  <!-- Ic√¥nes PWA -->
  <link rel="icon" type="image/png" sizes="192x192" href="/static/icons/icon-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/static/icons/icon-512x512.png">
  <link rel="apple-touch-icon" href="/static/icons/icon-192x192.png">

  <!-- Scripts -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link rel="icon" href="/favicon" type="image/x-icon" />

  <!-- Script commun -->
  <script src="/common.js"></script>

  <!-- Feuille de style principale - Th√®me Dark Organis√© -->
  <link rel="stylesheet" href="/base.css">

<style>

/* Variables CSS th√®me sombre */
:root {
  --primary-blue: #60a5fa;
  --primary-green: #34d399;
  --primary-red: #f87171;
  --primary-orange: #fb923c;
  --bg-dark: #0f172a;
  --bg-card: #1e293b;
  --text-light: #f1f5f9;
  --text-gray: #94a3b8;
  --border-dark: #334155;
  --shadow-dark: 0 4px 6px -1px rgba(0, 0, 0, 0.4), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
  --shadow-dark-medium: 0 10px 15px -3px rgba(0, 0, 0, 0.4), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
  --shadow-dark-strong: 0 20px 25px -5px rgba(0, 0, 0, 0.4), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
}

/* Fond de page dark */
body {
  background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%) !important;
  color: var(--text-light) !important;
  min-height: 100vh;
}

.btn-secondary, .btn-primary {
  font-size: 0.875rem !important;
}

/* Cacher √©l√©ments admin pour cette page entrepreneur */
li[data-role*="admin"]:not([data-role*="entrepreneur"]),
li[data-role="coach"] {
  display: none !important;
}

/* Header mobile courb√© */
.curved-header {
  position: relative;
  filter: drop-shadow(0 -8px 18px rgba(59, 130, 246, 0.2));
}

/* Case s√©lectionn√©e plus large */
.flex-2 {
  flex: 1.5;
}

/* Animations avec transform */
.icon-container {
  transition: transform 1s ease-in-out,
              box-shadow 0.7s ease-in-out;
  transform-origin: center;
}

.icon-container.selected {
  transform: scale(1.4) translateY(-8px);
}

.icon-container:hover:not(.selected) {
  transform: scale(1.05);
  transition: transform 0.2s ease-out;
}

.case-container {
  transition: flex 1s ease-in-out;
}

.icon-title {
  opacity: 0;
  transform: translateY(8px);
  transition: all 0.7s ease-in-out;
}

.icon-title.show {
  opacity: 1;
  transform: translateY(0);
}

/* Pas d'animation pour les ic√¥nes √† l'int√©rieur */
.icon-container i {
  transition: none;
}

.curved-header::before {
  content: '';
  position: absolute;
  top: -100px;
  left: 0;
  right: 0;
  height: 100px;
  background: #334155;
  clip-path: ellipse(85% 100% at 50% 100%);
}

.mobile-profile-icon {
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: rgba(59, 130, 246, 0.3) 0px 2px 6px;
  border-radius: 8px;
  background: linear-gradient(135deg, rgb(37, 134, 253) 0%, rgba(178, 197, 251, 0.78) 100%);
  overflow: hidden;
  cursor: pointer;
  aspect-ratio: 1;
}

.mobile-profile-icon i {
  color: white;
  font-size: 16px;
}

.mobile-settings-icon {
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 8px;
  background: #475569;
  cursor: pointer;
  aspect-ratio: 1;
}

.mobile-settings-icon i {
  color: white;
  font-size: 16px;
}

.mobile-profile-container {
  position: relative;
}

.mobile-profile-dropdown {
  position: absolute;
  top: calc(100% + 8px);
  right: 0;
  background: #1e293b;
  border: 1px solid #334155;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  min-width: 200px;
  z-index: 50;
  opacity: 0;
  transform: translateY(-10px) scale(0.95);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  pointer-events: none;
}

.mobile-profile-dropdown.show {
  opacity: 1;
  transform: translateY(0) scale(1);
  pointer-events: auto;
}

.mobile-profile-header {
  padding: 12px 16px;
}

.mobile-profile-info {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.mobile-username {
  color: #f1f5f9;
  font-weight: 600;
  font-size: 14px;
}

.mobile-role {
  color: #94a3b8;
  font-size: 12px;
}

.mobile-profile-divider {
  height: 1px;
  background: #334155;
  margin: 0 8px;
}

.mobile-logout-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  width: 100%;
  padding: 12px 16px;
  color: #f87171;
  font-size: 14px;
  background: transparent;
  border: none;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.mobile-logout-btn:hover {
  background: rgba(248, 113, 113, 0.1);
}

.hidden {
  display: none;
}

.mobile-logo-container {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
}

.mobile-logo {
  height: 50px;
  width: auto;
  object-fit: contain;
}

/* ================================================================
   GESTION CONTAINERS STYLES - M√äME STYLE QUE OUTILSMOBILE
   ================================================================ */

.tool-container {
  border-radius: 16px;
  padding: 2rem;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
  height: 225px !important;
  display: flex;
  align-items: center;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
}

.tool-container:hover {
  transform: translateY(-8px);
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
}

.tool-container::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.1);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.tool-container:hover::before {
  opacity: 1;
}

.tool-content {
  position: relative;
  z-index: 2;
  width: 100%;
  color: white;
}

.tool-icon-container {
  width: 80px;
  height: 80px;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 1.5rem;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.tool-icon-container i {
  font-size: 2.5rem;
  color: white;
}

.tool-title {
  font-size: 0.9rem;
  font-weight: 600;
  margin-bottom: 0;
  color: white;
}

.tool-description {
  font-size: 0.8rem;
  opacity: 0.9;
  margin-bottom: 1rem;
  line-height: 1.3;
  color: white;
}

.tool-arrow {
  position: absolute;
  top: 2rem;
  right: 1rem;
  width: 40px;
  height: 40px;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
}

/* Pour les sections en grille mobile (2 sections du haut), fl√®che encore plus √† droite */
@media (max-width: 767px) {
  .grid-cols-2 .tool-container:nth-child(-n+2) .tool-arrow {
    right: -20px;
  }
}

.tool-container:hover .tool-arrow {
  background: rgba(255, 255, 255, 0.3);
  transform: translateX(5px);
}

.tool-arrow i {
  font-size: 1rem;
  color: white;
}

/* Responsive pour mobile */
@media (max-width: 768px) {
  .tool-container {
    padding: 1.5rem;
    min-height: 180px;
  }

  .tool-icon-container {
    width: 60px;
    height: 60px;
    margin-bottom: 1rem;
  }

  .tool-icon-container i {
    font-size: 2rem;
  }

  .tool-title {
    font-size: 1.4rem;
    margin-bottom: 0;
  }

  .tool-description {
    font-size: 0.9rem;
    margin-bottom: 1rem;
  }

  .tool-arrow {
    width: 35px;
    height: 35px;
    top: 1.5rem;
    right: 0.75rem;
  }

  .tool-arrow i {
    font-size: 0.9rem;
  }
}

/* Petite fl√®che diagonale discr√®te en haut √† droite */
.tool-corner-arrow {
  position: absolute;
  top: 0.75rem;
  right: 0.75rem;
  color: rgba(255, 255, 255, 0.6);
  font-size: 0.7rem;
  transition: all 0.3s ease;
}

.tool-container:hover .tool-corner-arrow {
  color: rgba(255, 255, 255, 0.9);
  transform: translate(2px, -2px);
}

.tool-container:hover::before {
  opacity: 1;
}

.tool-content {
  position: relative;
  z-index: 2;
  width: 100%;
  color: white;
}

.tool-icon-container {
  width: 80px;
  height: 80px;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 1.5rem;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.tool-icon-container i {
  font-size: 2.5rem;
  color: white;
}

.tool-title {
  font-size: 0.9rem;
  font-weight: 600;
  margin-bottom: 0;
  color: white;
}

.tool-description {
  font-size: 0.8rem;
  opacity: 0.9;
  margin-bottom: 1rem;
  line-height: 1.3;
  color: white;
}

.tool-arrow {
  position: absolute;
  top: 2rem;
  right: 1rem;
  width: 40px;
  height: 40px;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
}

/* Pour les sections en grille mobile (2 sections du haut), fl√®che encore plus √† droite */
@media (max-width: 767px) {
  .grid-cols-2 .tool-container:nth-child(-n+2) .tool-arrow {
    right: -20px;
  }
}

.tool-container:hover .tool-arrow {
  background: rgba(255, 255, 255, 0.3);
  transform: translateX(5px);
}

.tool-arrow i {
  font-size: 1rem;
  color: white;
}

/* Responsive pour mobile */
@media (max-width: 768px) {
  .tool-container {
    padding: 2rem;
    min-height: 250px;
  }

  .tool-icon-container {
    width: 70px;
    height: 70px;
    margin-bottom: 1.5rem;
  }

  .tool-icon-container i {
    font-size: 2.2rem;
  }

  .tool-title {
    font-size: 1.4rem;
    margin-bottom: 0;
  }

  .tool-description {
    font-size: 1rem;
    margin-bottom: 1rem;
  }

  .tool-arrow {
    width: 35px;
    height: 35px;
    top: 1.5rem;
    right: 0.75rem;
  }

  .tool-arrow i {
    font-size: 0.9rem;
  }

  /* Ajuster l'espacement et padding sur mobile */
  .main-content {
    padding: 1rem !important;
  }

  /* Supprimer le spacer h-4 sur mobile pour matcher dashboard et travaux */
  .md\:hidden.h-4 {
    display: none !important;
  }
}

</style>

</head>

<body class="min-h-screen" style="background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); color: var(--text-light); overflow-x: hidden; margin: 0; padding: 0;">


  <!-- Menu lat√©ral - Dark Theme (VIDE) -->
  <div id="sidebar" class="hidden md:block fixed top-0 left-0 h-screen w-[14vw] shadow-lg z-20">
    <div class="border-b flex items-center justify-start space-x-2 py-4 pl-6">
      <img src="https://i.ibb.co/1fzHGQWw/TES-MUTE-TH-O-6.png" alt="Logo" class="h-6 w-auto object-contain">
      <span class="text-xl font-medium" style="color: var(--text-light);">Menu</span>
    </div>
    <ul class="p-4 space-y-3">
      <!-- Menu vide - ajoutez vos √©l√©ments ici -->
    </ul>
  </div>

  <!-- Header sp√©cial th√®me dark -->
  <div class="dark-header hidden md:block">
    <div class="header-content">
      <!-- Logo container simple -->
      <div class="logo-container">
        <img src="https://i.ibb.co/N6M9W7td/Design-sans-titre-46.png" alt="Logo" class="logo-image" />
      </div>

      <!-- Spacer pour pousser le menu account √† droite -->
      <div class="flex-1"></div>

      <!-- Account menu styl√© -->
      <div class="account-container">
        <button id="account-menu-button" class="account-btn">
          <div class="account-avatar">
            <img src="https://i.ibb.co/twJsgZrb/Design-sans-titre-39.png" alt="Compte" />
          </div>
          <div class="account-info" id="account-display">
            Chargement...
          </div>
          <i class="fas fa-chevron-down account-chevron"></i>
        </button>

        <div id="account-dropdown" class="account-dropdown hidden">
          <div class="dropdown-header">
            <div class="user-avatar">
              <img src="https://i.ibb.co/twJsgZrb/Design-sans-titre-39.png" alt="Compte" />
            </div>
            <div class="user-details">
              <div class="user-name" id="account-username">Chargement...</div>
            </div>
          </div>
          <div class="dropdown-divider"></div>
          <button onclick="window.location.href='/connection'" class="dropdown-item">
            <i class="fas fa-cog"></i>
            <span>Param√®tres</span>
          </button>
          <button onclick="logout()" class="dropdown-item logout">
            <i class="fas fa-sign-out-alt"></i>
            <span>Se d√©connecter</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Contenu principal -->
  <div class="main-content w-full" style="width: 100%; padding: 2rem;">
    <div class="md:hidden h-4"></div>
    <div class="w-full">

      <!-- Header -->
      <div class="mb-10 mt-5 md:mt-0">
        <div class="relative">
          <div class="flex items-center justify-between mb-3">
            <h1 class="text-4xl font-bold" style="color: var(--text-light);">
              Gestion & Administration
            </h1>
            <span class="absolute -bottom-2 left-0 w-20 h-1 bg-gradient-to-r from-blue-600 to-blue-400 rounded-full"></span>
          </div>
          <div class="flex items-center justify-between">
            <p class="text-xl font-medium" style="color: var(--text-gray);">Outils de gestion</p>
          </div>
        </div>
      </div>

      <!-- Grille: sur mobile 2+1, sur desktop 3 c√¥te √† c√¥te -->
      <div class="space-y-6 md:space-y-0">

        <!-- Sur mobile: 2 en haut, 1 en bas | Sur desktop: 3 c√¥te √† c√¥te -->
        <div class="grid grid-cols-2 md:grid-cols-3 gap-6">

          <!-- Gestion Employ√©s -->
          <div class="tool-container" onclick="navigateTo('/gestionemployes')" style="background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%);">
            <div class="tool-content text-center">
              <div class="tool-icon-container mx-auto">
                <i class="fas fa-users"></i>
              </div>
              <h3 class="tool-title">Employ√©s</h3>
            </div>
            <div class="tool-corner-arrow">
              <i class="fas fa-external-link-alt"></i>
            </div>
          </div>

          <!-- Avis Client -->
          <div class="tool-container" onclick="navigateTo('/avis')" style="background: linear-gradient(135deg, #eab308 0%, #ca8a04 100%);">
            <div class="tool-content text-center">
              <div class="tool-icon-container mx-auto">
                <i class="fas fa-star"></i>
              </div>
              <h3 class="tool-title">Avis</h3>
            </div>
            <div class="tool-corner-arrow">
              <i class="fas fa-external-link-alt"></i>
            </div>
          </div>

          <!-- Facturation QE - gris√© (d√©sactiv√© pour l'instant) -->
          <div class="tool-container opacity-50 cursor-not-allowed" style="background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);" title="Bient√¥t disponible">
            <div class="tool-content text-center">
              <div class="tool-icon-container mx-auto">
                <i class="fas fa-receipt"></i>
              </div>
              <h3 class="tool-title">Facturation QE</h3>
            </div>
            <div class="tool-corner-arrow">
              <i class="fas fa-lock"></i>
            </div>
          </div>

          <!-- La Centrale - violet -->
          <div class="tool-container" onclick="navigateTo('/centralevue')" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">
            <div class="tool-content text-center">
              <div class="tool-icon-container mx-auto">
                <i class="fas fa-building"></i>
              </div>
              <h3 class="tool-title">La Centrale</h3>
            </div>
            <div class="tool-corner-arrow">
              <i class="fas fa-external-link-alt"></i>
            </div>
          </div>

        </div>

      </div>

    </div>
  </div>

<script>
// Navigation helper - passe le param√®tre ?user= aux sous-pages
function navigateTo(path) {
  const urlParams = new URLSearchParams(window.location.search);
  const user = urlParams.get('user');
  if (user) {
    window.location.href = path + '?user=' + encodeURIComponent(user);
  } else {
    window.location.href = path;
  }
}

// Scripts de base pour le fonctionnement du template
document.addEventListener('DOMContentLoaded', function() {

  // Account dropdown
  const accountMenuButton = document.getElementById('account-menu-button');
  const accountDropdown = document.getElementById('account-dropdown');

  if (accountMenuButton && accountDropdown) {
    accountMenuButton.addEventListener('click', function(e) {
      e.preventDefault();
      accountDropdown.classList.toggle('hidden');
    });

    // Fermer le dropdown en cliquant ailleurs
    document.addEventListener('click', function(e) {
      if (!accountMenuButton.contains(e.target) && !accountDropdown.contains(e.target)) {
        accountDropdown.classList.add('hidden');
      }
    });
  }

});


// Fonction logout (√† personnaliser selon votre backend)
function logout() {
  // Ajoutez votre logique de d√©connexion ici
  console.log('D√©connexion...');
  // window.location.href = '/logout';
}

// Variable pour tracker l'ic√¥ne s√©lectionn√©e
let selectedIcon = 5; // Gestion par d√©faut

// Fonction pour s√©lectionner une ic√¥ne
function selectIcon(iconNumber, title, iconClass) {
  if (selectedIcon === iconNumber) return; // √âviter de re-s√©lectionner

  const previousSelected = selectedIcon;
  selectedIcon = iconNumber;

  // Donn√©es des ic√¥nes
  const icons = [
    { id: 1, title: 'RPO' },
    { id: 2, title: 'Ventes' },
    { id: 3, title: 'Dashboard' },
    { id: 4, title: 'Outils' },
    { id: 5, title: 'Gestion' }
  ];

  // Trouver les conteneurs des ic√¥nes
  const containers = document.querySelectorAll('.case-container');
  const iconContainers = document.querySelectorAll('.icon-container');
  const iconElements = document.querySelectorAll('.icon-container i');
  const titleElements = document.querySelectorAll('.icon-title');

  containers.forEach((container, index) => {
    const iconId = index + 1;
    const isSelected = iconId === selectedIcon;
    const iconContainer = iconContainers[index];
    const iconElement = iconElements[index];

    // Animer le conteneur de la case
    if (isSelected) {
      container.className = 'flex-2 case-container flex flex-col justify-center items-center h-full';
    } else {
      container.className = 'flex-1 case-container flex justify-center items-center h-full';
    }

    // Animer l'ic√¥ne avec transform
    if (isSelected) {
      iconContainer.classList.add('selected');
      iconContainer.classList.remove('shadow-lg');
      iconContainer.classList.add('shadow-xl');
      iconElement.className = iconElement.className.replace(/text-\w+/, 'text-xl');
    } else {
      iconContainer.classList.remove('selected');
      iconContainer.classList.remove('shadow-xl');
      iconContainer.classList.add('shadow-lg');
      iconElement.className = iconElement.className.replace(/text-\w+/, 'text-sm');
    }
  });

  // G√©rer les titres
  titleElements.forEach(title => title.remove());

  // Ajouter le nouveau titre pour l'ic√¥ne s√©lectionn√©e
  const selectedContainer = containers[selectedIcon - 1];
  if (selectedContainer) {
    const titleSpan = document.createElement('span');
    titleSpan.className = 'text-xs font-medium mt-1 icon-title show';
    titleSpan.style.color = 'var(--text-light)';
    titleSpan.textContent = icons[selectedIcon - 1].title;
    selectedContainer.appendChild(titleSpan);
  }
}

// Fonction pour toggle le dropdown mobile
function toggleMobileProfileMenu() {
  const dropdown = document.getElementById('mobile-profile-dropdown');

  if (dropdown.classList.contains('show')) {
    // Fermer avec animation
    dropdown.classList.remove('show');
    setTimeout(() => {
      dropdown.classList.add('hidden');
    }, 300); // D√©lai correspondant √† la dur√©e de transition
  } else {
    // Ouvrir avec animation
    dropdown.classList.remove('hidden');
    setTimeout(() => {
      dropdown.classList.add('show');
    }, 10); // Petit d√©lai pour permettre le rendu
  }
}

// Fermer le dropdown si on clique ailleurs
document.addEventListener('click', function(event) {
  const container = document.querySelector('.mobile-profile-container');
  const dropdown = document.getElementById('mobile-profile-dropdown');

  if (container && !container.contains(event.target) && dropdown.classList.contains('show')) {
    dropdown.classList.remove('show');
    setTimeout(() => {
      dropdown.classList.add('hidden');
    }, 300);
  }
});

// Charger les donn√©es utilisateur au d√©marrage
window.addEventListener('load', function() {
  // V√©rifier si les fonctions de common.js sont disponibles
  if (typeof getCurrentUser === 'function') {
    const userData = getCurrentUser();
    if (userData) {
      document.getElementById('mobile-username').textContent = userData.username || 'Utilisateur';
      document.getElementById('mobile-role').textContent = userData.role || 'Utilisateur';
    }
  } else if (typeof username !== 'undefined' && typeof role !== 'undefined') {
    // Si les variables globales existent
    document.getElementById('mobile-username').textContent = username || 'Utilisateur';
    document.getElementById('mobile-role').textContent = role || 'Utilisateur';
  }
});
</script>

</body>
</html>
